#a = ['福建省厦门市', '福建省泉州市晋江市', '福建省', '福建省泉州市', '福建省厦门市同安区', '福建省福州市', '福建省泉州市南安县', '福建省漳州市', '福建省南平市', '福建省三明市', '福建省龙岩市', '福建省宁德市', '福建省福州市长乐市', '福建省厦门市湖里区', '福建省泉州市石狮市', '福建省莆田市', '福建省莆田市涵江区', '福建省厦门市集美区', '福建省漳州市漳浦县', '福建省泉州市泉港区', '福建省宁德市寿宁县', '福建省三明市永安市', '福建省宁德市古田县', '福建省龙岩市长汀县', '福建省厦门市思明区', '福建省宁德市福安市', '福建省三明市泰宁县', '福建省福州市福清市', '福建省泉州市安溪县', '福建省福州市连江县', '福建省漳州市平和县', '福建省泉州市惠安县', '福建省宁德市福鼎市', '福建省福州市闽侯县', '福建省厦门市海沧区', '福建省莆田市荔城区', '福建省南平市武夷山市', '福建省福州市罗源县', '福建省宁德市柘荣县', '福建省龙岩市新罗区', '福建省莆田市仙游县', '福建省福州市仓山区', '福建省泉州市德化县', '福建省莆田市城厢区', '福建省三明市永安县', '福建省泉州市晋江县', '福建省福州市鼓楼区', '福建省南平市建阳市', '福建省龙岩市连城县', '福建省福州市平潭县', '福建省宁德市周宁县', '福建省福州市永泰县', '福建省泉州市永春县', '福建省莆田市秀屿区', '福建省南平市邵武市', '福建省龙岩市武平县', '福建省宁德市霞浦县', '福建省漳州市龙海市', '福建省南平市政和县', '福建省福州市闽清县', '福建省漳州市诏安县', '福建省漳州市龙海县', '福建省南平市浦城县', '福建省福州市马尾区', '福建省三明市建宁县', '福建省南平市光泽县', '福建省南平市顺昌县', '福建省福州市晋安区', '福建省龙岩市漳平市', '福建省南平市松溪县', '福建省泉州市南安市', '福建省宁德市蕉城区', '福建省漳州市云霄县', '福建省漳州市南靖县', '福建省南平市建瓯市', '福建省三明市梅列区', '福建省漳州市芗城区', '福建省漳州市华安县', '福建省漳州市长泰县', '福建省泉州市丰泽区', '福建省福州市台江区', '福建省龙岩市上杭县', '福建省三明市将乐县', '福建省厦门市翔安区', '福建省福州市闽侯县青口镇']
#a = ['山西省忻州市', '山西省阳泉市', '山西省大同市', '山西省运城市', '山西省晋城市阳城县', '山西省', '山西省吕梁市离石区', '山西省晋城市', '山西省太原市', '山西省晋中市', '山西省太原市小店区', '山西省长治市', '山西省临汾市', '山西省朔州市', '山西省吕梁市', '山西省长治市潞城市', '山西省临汾市霍州市', '山西省晋中市榆次区', '山西省运城市芮城县', '山西省运城市万荣县', '山西省临汾市洪洞县', '山西省太原市迎泽区', '山西省晋城市沁水县', '山西省忻州市五寨县', '山西省运城市闻喜县', '山西省长治市武乡县', '山西省晋城市高平市', '山西省长治市襄垣县', '山西省晋城市陵川县', '山西省临汾市侯马市', '山西省大同市灵丘县', '山西省吕梁市孝义市', '山西省运城市绛县', '山西省吕梁市汾阳市', '山西省长治市长子县', '山西省运城市临猗县', '山西省晋中市介休市', '山西省长治市黎城县', '山西省吕梁市柳林县', '山西省晋中市灵石县', '山西省运城市稷山县', '山西省长治市屯留县', '山西省长治市沁县', '山西省吕梁市临县', '山西省吕梁市交口县', '山西省大同市广灵县', '山西省忻州市原平市', '山西省忻州市五台县', '山西省晋中市左权县', '山西省晋中市太谷县', '山西省晋中市昔阳县', '山西省太原市古交市', '山西省运城市河津市', '山西省忻州市保德县', '山西省长治市平顺县', '山西省晋中市平遥县', '山西省朔州市应县', '山西省吕梁市文水县', '山西省太原市清徐县', '山西省运城市平陆县', '山西省忻州市宁武县', '山西省吕梁市石楼县', '山西省朔州市右玉县', '山西省临汾市隰县', '山西省吕梁市方山县', '山西省临汾市襄汾县', '山西省长治市壶关县', '山西省太原市万柏林区', '山西省忻州市繁峙县', '山西省阳泉市盂县', '山西省晋中市和顺县', '山西省大同市天镇县', '山西省临汾市翼城县', '山西省晋中市祁县', '山西省运城市永济市', '山西省大同市阳高县', '山西省大同市浑源县', '山西省太原市尖草坪区', '山西省大同市左云县', '山西省忻州市代县', '山西省大同市大同县', '山西省运城市新绛县', '山西省临汾市乡宁县', '山西省阳泉市平定县', '山西省朔州市怀仁县', '山西省吕梁市交城县', '山西省朔州市山阴县', '山西省太原市杏花岭区', '山西省朔州市平鲁区', '山西省吕梁市兴县', '山西省临汾市曲沃县', '山西省临汾市永和县', '山西省吕梁市岚县', '山西省忻州市定襄县', '山西省忻州市神池县', '山西省临汾市蒲县', '山西省忻州市河曲县', '山西省临汾市尧都区', '山西省临汾市安泽县']
a = ['广东省东莞市', '广东省佛山市', '广东省广州市', '广东省深圳市', '广东省', '广东省惠州市', '广东省揭阳市', '广东省珠海市', '广东省中山市', '广东省湛江市', '广东省江门市', '广东省韶关市', '广东省茂名市', '广东省肇庆市', '广东省汕尾市', '广东省清远市', '广东省广州市越秀区', '广东省佛山市顺德区', '广东省江门市鹤山市', '广东省梅州市', '广东省广州市天河区', '广东省韶关市新丰县', '广东省汕头市', '广东省深圳市龙岗区', '广东省潮州市', '广东省深圳市罗湖区', '广东省惠州市惠阳区', '广东省佛山市三水区', '广东省佛山市南海区', '广东省汕头市潮阳区', '广东省云浮市', '广东省韶关市南雄市', '广东省江门市蓬江区', '广东省深圳市福田区', '广东省佛山市禅城区', '广东省肇庆市端州区', '广东省佛山市高明区', '广东省湛江市雷州市', '广东省江门市新会区', '广东省河源市龙川县', '广东省深圳市南山区', '广东省广州市荔湾区', '广东省广州市白云区', '广东省广州市黄埔区', '广东省阳江市', '广东省河源市', '广东省清远市清城区', '广东省揭阳市普宁市', '广东省广州市从化市', '广东省广州市番禺区', '广东省汕尾市陆丰县', '广东省梅州市蕉岭县', '广东省清远市清新县', '广东省广州市从化区', '广东省汕头市潮南区', '广东省深圳市宝安区', '广东省广州市海珠区', '广东省珠海市香洲区', '广东省江门市开平市', '广东省江门市恩平市', '广东省湛江市吴川县', '广东省湛江市赤坎区', '广东省潮州市潮安县', '广东省梅州市梅江区', '广东省湛江市廉江市', '广东省梅州市梅县', '广东省汕尾市海丰县', '广东省广州市南沙区', '广东省潮州市饶平县', '广东省阳江市阳春市', '广东省茂名市高州市', '广东省阳江市江城区', '广东省茂名市信宜市', '广东省江门市台山市', '广东省广州市花都区', '广东省广州市增城区', '广东省肇庆市四会市', '广东省清远市英德市', '广东省肇庆市封开县', '广东省韶关市乳源县', '广东省潮州市湘桥区', '广东省惠州市惠东县', '广东省阳江市阳西县', '广东省茂名市电白县', '广东省汕头市澄海区', '广东省揭阳市揭东县', '广东省韶关市翁源县', '广东省揭阳市惠来县', '广东省惠州市惠城区', '广东省韶关市仁化县', '广东省揭阳市揭西县', '广东省珠海市金湾区', '广东省惠州市博罗县', '广东省清远市连山县', '广东省深圳市盐田区', '广东省肇庆市德庆县', '广东省茂名市茂港区', '广东省肇庆市怀集县', '广东省茂名市茂南区', '广东省清远市连州市', '广东省清远市阳山县', '广东省肇庆市广宁县', '广东省清远市佛冈县', '广东省珠海市斗门区', '广东省韶关市武江区', '广东省河源市连平县', '广东省梅州市丰顺县', '广东省韶关市始兴县', '广东省梅州市兴宁市', '广东省韶关市曲江区', '广东省河源市紫金县', '广东省云浮市罗定市', '广东省惠州市龙门县', '广东省云浮市云安县', '广东省湛江市吴川市', '广东省河源市东源县', '广东省湛江市霞山区', '广东省梅州市平远县', '广东省茂名市化州市', '广东省肇庆市高要区', '广东省湛江市坡头区', '广东省湛江市徐闻县', '广东省江门市江海区', '广东省河源市和平县', '广东省梅州市五华县', '广东省广州市萝岗区', '广东省湛江市麻章区', '广东省阳江市阳东县', '广东省云浮市郁南县', '广东省梅州市大埔县', '广东省江门市开平县', '广东省韶关市乐昌市', '广东省汕头市金平区', '广东省湛江市遂溪县', '广东省汕尾市陆丰市', '广东省云浮市新兴县', '广东省汕尾市陆河县', '广东省广州市黄浦区', '广东省揭阳市榕城区', '广东省广州市花都区新华镇']

from pymongo import MongoClient
from collections import OrderedDict
client = MongoClient('10.8.8.111',27017)
db = client.cache
coll = db.userAttr
c = OrderedDict()
file4=open('user.csv','w',encoding='utf-8')
for i in a:
    c[i]=0
b = coll.aggregate([{'$match':{'location':{'$in':a}}},
                    {'$project':{'location':1}},
                    {'$group':{'_id':'$location','count':{'$sum':1}}}
                    ])
for i in b:
    c[i['_id']]=i['count']
for i in c:
    file4.write(str(c[i]))
    file4.write('\n')
file4.close()
